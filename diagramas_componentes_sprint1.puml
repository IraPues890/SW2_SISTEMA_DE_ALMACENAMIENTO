@startuml diagramas_componentes_sprint1

!define COMPONENT component
!define INTERFACE interface
!define DATABASE database

title **ğŸ—ï¸ DIAGRAMAS DE COMPONENTES POR HISTORIA DE USUARIO**\n//Sprint 1 - Sistema UlStorage//

skinparam componentStyle rectangle
skinparam component {
    BackgroundColor #E8F4FD
    BorderColor #2E86AB
    ArrowColor #A23B72
}

skinparam interface {
    BackgroundColor #FFF3CD
    BorderColor #856404
}

skinparam database {
    BackgroundColor #D1ECF1
    BorderColor #0C5460
}

' ===============================
' SCRUM-5: INICIAR SESIÃ“N
' ===============================
!startsub SCRUM5

package "ğŸ” SCRUM-5: Iniciar SesiÃ³n" as scrum5 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum5_frontend {
        COMPONENT [ğŸ“± Componente Login] as login_comp
        COMPONENT [ğŸ“ Formulario Login] as login_form
        COMPONENT [âš ï¸ Manejador Errores] as error_handler
    }
    
    ' Backend Components  
    package "ğŸ”§ Backend" as scrum5_backend {
        COMPONENT [ğŸ” Controlador Login] as auth_ctrl
        COMPONENT [ï¿½ Validador Credenciales] as credential_validator
        COMPONENT [ğŸ”‘ Comparador ContraseÃ±a] as pwd_validator
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum5_data {
        COMPONENT [ğŸ‘¤ Repositorio Usuario] as user_repo
        COMPONENT [ğŸ‘¤ Modelo Usuario] as user_model
        DATABASE "ğŸ˜ PostgreSQL" as db_users
    }
    
    ' Flujo de componentes simplificado
    login_comp --> login_form
    login_form --> auth_ctrl
    auth_ctrl --> credential_validator
    credential_validator --> pwd_validator
    credential_validator --> user_repo
    user_repo --> user_model
    user_model --> db_users
    
    ' Error handling
    auth_ctrl --> error_handler
    credential_validator --> error_handler
}

note right of scrum5 : **Criterio de AceptaciÃ³n:**\nVerificaciÃ³n simple de email y contraseÃ±a\ncontra datos guardados en BD.\nSin tokens ni middleware complejo.

!endsub

' ===============================
' SCRUM-6: CERRAR SESIÃ“N
' ===============================
!startsub SCRUM6

package "ğŸšª SCRUM-6: Cerrar SesiÃ³n" as scrum6 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum6_frontend {
        COMPONENT [ğŸšª BotÃ³n Cerrar SesiÃ³n] as logout_btn
        COMPONENT [ğŸ”„ Manejador RedirecciÃ³n] as redirect_handler
        COMPONENT [ğŸ§¹ Limpiador SesiÃ³n] as session_cleaner
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum6_backend {
        COMPONENT [ï¿½ Controlador Logout] as logout_ctrl
        COMPONENT [ğŸ“ Logger BÃ¡sico] as logout_log
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum6_data {
        DATABASE "ğŸ˜ PostgreSQL" as db_sessions
    }
    
    ' Flujo de componentes simplificado
    logout_btn --> logout_ctrl
    logout_ctrl --> session_cleaner
    logout_ctrl --> logout_log
    logout_ctrl --> redirect_handler
    logout_log --> db_sessions
    
}

note right of scrum6 : **Criterio de AceptaciÃ³n:**\nCerrar sesiÃ³n simple limpiando\nsesiÃ³n local sin manejo de tokens

!endsub

' ===============================
' SCRUM-10: PANEL PRINCIPAL
' ===============================
!startsub SCRUM10

package "ğŸ“Š SCRUM-10: Panel Principal de NavegaciÃ³n" as scrum10 {
    
    ' Frontend Components (Arquitectura Real)
    package "ğŸ–¥ï¸ Frontend" as scrum10_frontend {
        COMPONENT [ğŸ“Š DashUser/DashAdmin] as dashboard
        COMPONENT [ğŸ“ ActiveFilesTable] as file_list
        COMPONENT [ğŸ—‚ï¸ Ãrbol Carpetas] as folder_tree
        COMPONENT [ğŸ“ˆ GlobalMetrics] as metrics_panel
        COMPONENT [ğŸ‘¤ UserHeader] as user_header
        COMPONENT [âš¡ QuickActions] as quick_actions
        COMPONENT [ï¿½ï¸ ServersStatus] as servers_status
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum10_backend {
        COMPONENT [ğŸ“„ Controlador Archivo] as file_ctrl
        COMPONENT [ğŸ“ Controlador Carpeta] as folder_ctrl
        COMPONENT [ğŸ“Š Servicio Dashboard] as dash_svc
        COMPONENT [ğŸ“ˆ Servicio MÃ©tricas] as metrics_svc
        COMPONENT [ğŸ—‚ï¸ Servicio NavegaciÃ³n] as nav_svc
        COMPONENT [â˜ï¸ Controlador Proveedor] as provider_ctrl
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum10_data {
        COMPONENT [ğŸ“„ Repositorio Archivo] as file_repo_dash
        COMPONENT [ğŸ“ Repositorio Carpeta] as folder_repo_dash
        COMPONENT [ğŸ“Š Repositorio MÃ©tricas] as metrics_repo
        DATABASE "ğŸ˜ PostgreSQL" as db_files
    }
    
    ' Cloud Storage Multi-Proveedor
    package "â˜ï¸ Storage" as scrum10_storage {
        COMPONENT [ğŸ­ FÃ¡brica Almacenamiento] as storage_factory
        COMPONENT [ğŸ…¾ï¸ Repositorio OCI] as oci_provider
        COMPONENT [ğŸŸ  Repositorio AWS] as aws_provider
        COMPONENT [ğŸ”µ Repositorio Azure] as azure_provider
        COMPONENT [ğŸŸ¢ Repositorio GCP] as gcp_provider
    }
    
    ' Flujo principal (Componentes Reales)
    dashboard --> user_header
    dashboard --> metrics_panel
    dashboard --> quick_actions
    dashboard --> file_list
    dashboard --> servers_status
    
    file_list --> file_ctrl
    folder_tree --> folder_ctrl
    metrics_panel --> dash_svc
    
    file_ctrl --> dash_svc
    folder_ctrl --> dash_svc
    dash_svc --> metrics_svc
    dash_svc --> nav_svc
    
    dash_svc --> file_repo_dash
    dash_svc --> folder_repo_dash
    metrics_svc --> metrics_repo
    
    file_repo_dash --> db_files
    folder_repo_dash --> db_files
    metrics_repo --> db_files
    
    dash_svc --> provider_ctrl
    provider_ctrl --> storage_factory
    storage_factory --> oci_provider
    storage_factory --> aws_provider
    storage_factory --> azure_provider
    storage_factory --> gcp_provider
}

note right of scrum10 : **Criterio de AceptaciÃ³n:**\nDashboard con vista general,\nlistado de archivos y navegaciÃ³n intuitiva\n\n**Arquitectura Multi-Cloud:**\nâ€¢ AWS S3 para almacenamiento rÃ¡pido\nâ€¢ Azure Blob para integraciÃ³n empresarial\nâ€¢ GCP Storage para analytics\nâ€¢ OCI para costos optimizados\nâ€¢ Factory Pattern para abstracciÃ³n

!endsub

' ===============================
' SCRUM-11: ACCIONES BÃSICAS
' ===============================
!startsub SCRUM11

package "âš¡ SCRUM-11: Acciones BÃ¡sicas del Panel" as scrum11 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum11_frontend {
        COMPONENT [ğŸ”˜ Botones AcciÃ³n] as action_buttons
        COMPONENT [ğŸ“¤ BotÃ³n Subir] as upload_btn
        COMPONENT [ğŸ“ BotÃ³n Crear Carpeta] as create_folder_btn
        COMPONENT [ğŸ” BotÃ³n BÃºsqueda] as search_btn
        COMPONENT [ğŸ’¡ Proveedor Tooltip] as tooltip_provider
    }
    
    ' Routing Components
    package "ğŸ›£ï¸ Navigation" as scrum11_nav {
        COMPONENT [ğŸ§­ Enrutador] as router
        COMPONENT [ğŸ”— Manejador Rutas] as route_handler
    }
    
    ' Flujo de componentes
    action_buttons --> upload_btn
    action_buttons --> create_folder_btn
    action_buttons --> search_btn
    action_buttons --> tooltip_provider
    
    upload_btn --> router : "/upload"
    create_folder_btn --> router : "/create-folder"
    search_btn --> router : "/search"
    
    router --> route_handler
}

note right of scrum11 : **Criterio de AceptaciÃ³n:**\nBotones de acciones principales visibles,\nnavegaciÃ³n responsive y tooltips

!endsub

' ===============================
' SCRUM-12: SUBIR ARCHIVOS
' ===============================
!startsub SCRUM12

package "ğŸ“¤ SCRUM-12: Subir Archivos" as scrum12 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum12_frontend {
        COMPONENT [ğŸ“¤ Componente Subir] as upload_comp
        COMPONENT [ğŸ“ Selector Archivo] as file_selector
        COMPONENT [ğŸ“Š Barra Progreso] as progress_bar
        COMPONENT [âœ… Validador Archivo] as file_validator_fe
        COMPONENT [ğŸ“‹ Cola Subida] as upload_queue
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum12_backend {
        COMPONENT [ğŸ“¤ Controlador Subida] as upload_ctrl
        COMPONENT [ğŸ” Validador Archivo] as file_validator_be
        COMPONENT [ğŸ“„ Servicio Archivo] as file_svc
        COMPONENT [ğŸ·ï¸ Extractor Metadatos] as metadata_extractor
        COMPONENT [ğŸ”„ Procesador Subida] as upload_processor
    }
    
    ' Storage Layer Multi-Cloud
    package "â˜ï¸ Storage" as scrum12_storage {
        COMPONENT [ğŸ­ FÃ¡brica Almacenamiento] as storage_fact
        COMPONENT [ğŸ…¾ï¸ Repositorio OCI] as oci_repo
        COMPONENT [ğŸŸ  Repositorio AWS] as aws_repo
        COMPONENT [ğŸ”µ Repositorio Azure] as azure_repo
        COMPONENT [ğŸŸ¢ Repositorio GCP] as gcp_repo
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum12_data {
        COMPONENT [ğŸ“„ Repositorio Archivo] as file_repo_up
        COMPONENT [ğŸ“ Logger BÃ¡sico] as log_repo
        DATABASE "ğŸ˜ PostgreSQL" as db_upload
    }
    
    ' Flujo completo de subida
    upload_comp --> file_selector
    file_selector --> file_validator_fe
    file_validator_fe --> upload_queue
    upload_queue --> progress_bar
    
    upload_comp --> upload_ctrl
    upload_ctrl --> file_validator_be
    file_validator_be --> upload_processor
    upload_processor --> file_svc
    upload_processor --> metadata_extractor
    
    file_svc --> storage_fact
    storage_fact --> oci_repo
    storage_fact --> aws_repo
    storage_fact --> azure_repo
    storage_fact --> gcp_repo
    
    file_svc --> file_repo_up
    file_svc --> log_repo
    file_repo_up --> db_upload
    log_repo --> db_upload
    
    ' Feedback al frontend
    upload_processor --> progress_bar
}

note right of scrum12 : **Criterio de AceptaciÃ³n:**\nSubir archivos con barra de progreso,\nvalidaciÃ³n de tamaÃ±o y tipo

!endsub

' ===============================
' SCRUM-13: DESCARGAR ARCHIVOS
' ===============================
!startsub SCRUM13

package "ğŸ“¥ SCRUM-13: Descargar Archivos" as scrum13 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum13_frontend {
        COMPONENT [ğŸ“¥ BotÃ³n Descargar] as download_btn
        COMPONENT [ğŸ“Š Progreso Descarga] as download_progress
        COMPONENT [ğŸ”— Gestor Descarga] as download_mgr
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum13_backend {
        COMPONENT [ğŸ“¥ Controlador Descarga] as download_ctrl
        COMPONENT [ğŸ‘¤ Validador Propietario] as perm_validator
        COMPONENT [ğŸ“„ Servicio Archivo] as file_svc_down
        COMPONENT [ğŸ”„ Manejador Stream] as stream_handler
    }
    
    ' Storage Layer Multi-Cloud
    package "â˜ï¸ Storage" as scrum13_storage {
        COMPONENT [ğŸ­ FÃ¡brica Almacenamiento] as storage_fact_down
        COMPONENT [ğŸ…¾ï¸ Repositorio OCI] as oci_repo_down
        COMPONENT [ğŸŸ  Repositorio AWS] as aws_repo_down
        COMPONENT [ğŸ”µ Repositorio Azure] as azure_repo_down
        COMPONENT [ğŸŸ¢ Repositorio GCP] as gcp_repo_down
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum13_data {
        COMPONENT [ğŸ“„ Repositorio Archivo] as file_repo_down
        COMPONENT [ğŸ“ Logger BÃ¡sico] as log_repo_down
        DATABASE "ğŸ˜ PostgreSQL" as db_download
    }
    
    ' Flujo de descarga
    download_btn --> download_ctrl
    download_ctrl --> perm_validator
    perm_validator --> file_svc_down
    file_svc_down --> storage_fact_down
    storage_fact_down --> oci_repo_down
    storage_fact_down --> aws_repo_down
    storage_fact_down --> azure_repo_down
    storage_fact_down --> gcp_repo_down
    
    file_svc_down --> stream_handler
    stream_handler --> download_mgr
    download_mgr --> download_progress
    
    file_svc_down --> file_repo_down
    file_svc_down --> log_repo_down
    file_repo_down --> db_download
    log_repo_down --> db_download
}

note right of scrum13 : **Criterio de AceptaciÃ³n:**\nDescargar archivos sin pÃ©rdida de calidad,\nmanejo de archivos grandes

!endsub

' ===============================
' SCRUM-14: PREVISUALIZAR ARCHIVOS
' ===============================
!startsub SCRUM14

package "ğŸ‘ï¸ SCRUM-14: Previsualizar Archivos" as scrum14 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum14_frontend {
        COMPONENT [ğŸ‘ï¸ Componente Vista Previa] as preview_comp
        COMPONENT [ğŸ“„ Visor PDF] as pdf_viewer
        COMPONENT [ğŸ–¼ï¸ Visor Imagen] as image_viewer
        COMPONENT [ğŸ“ Visor Texto] as text_viewer
        COMPONENT [ğŸ”„ FÃ¡brica Visor] as viewer_factory
        COMPONENT [ğŸ›ï¸ Controles Vista Previa] as preview_controls
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum14_backend {
        COMPONENT [ğŸ‘ï¸ Controlador Vista Previa] as preview_ctrl
        COMPONENT [ğŸ‘¤ Validador Propietario] as perm_val_prev
        COMPONENT [ğŸ“„ Servicio Vista Previa] as preview_svc
        COMPONENT [ğŸ”„ Generador Miniatura] as thumbnail_gen
        COMPONENT [ğŸ“‹ Detector Tipo MIME] as mime_detector
    }
    
    ' Storage Layer Multi-Cloud
    package "â˜ï¸ Storage" as scrum14_storage {
        COMPONENT [ğŸ­ FÃ¡brica Almacenamiento] as storage_fact_prev
        COMPONENT [ğŸ…¾ï¸ Repositorio OCI] as oci_repo_prev
        COMPONENT [ğŸŸ  Repositorio AWS] as aws_repo_prev
        COMPONENT [ğŸ”µ Repositorio Azure] as azure_repo_prev
        COMPONENT [ğŸŸ¢ Repositorio GCP] as gcp_repo_prev
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum14_data {
        COMPONENT [ğŸ“„ Repositorio Archivo] as file_repo_prev
        DATABASE "ğŸ˜ PostgreSQL" as db_preview
    }
    
    ' Flujo de previsualizaciÃ³n
    preview_comp --> viewer_factory
    viewer_factory --> pdf_viewer
    viewer_factory --> image_viewer
    viewer_factory --> text_viewer
    preview_comp --> preview_controls
    
    preview_comp --> preview_ctrl
    preview_ctrl --> perm_val_prev
    preview_ctrl --> preview_svc
    preview_svc --> mime_detector
    preview_svc --> thumbnail_gen
    
    preview_svc --> storage_fact_prev
    storage_fact_prev --> oci_repo_prev
    storage_fact_prev --> aws_repo_prev
    storage_fact_prev --> azure_repo_prev
    storage_fact_prev --> gcp_repo_prev
    
    preview_svc --> file_repo_prev
    file_repo_prev --> db_preview
}

note right of scrum14 : **Criterio de AceptaciÃ³n:**\nVisor integrado para PDF, imÃ¡genes y texto,\nnavegaciÃ³n entre pÃ¡ginas

!endsub

' ===============================
' SCRUM-15: ELIMINAR ARCHIVOS
' ===============================
!startsub SCRUM15

package "ğŸ—‘ï¸ SCRUM-15: Eliminar Archivos" as scrum15 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum15_frontend {
        COMPONENT [ğŸ—‘ï¸ BotÃ³n Eliminar] as delete_btn
        COMPONENT [âš ï¸ Modal ConfirmaciÃ³n] as confirm_modal
        COMPONENT [ğŸ”„ Manejador ActualizaciÃ³n] as refresh_handler
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum15_backend {
        COMPONENT [ğŸ—‘ï¸ Controlador Eliminar] as delete_ctrl
        COMPONENT [ğŸ‘¤ Validador Propietario] as perm_val_del
        COMPONENT [ğŸ“„ Servicio Archivo] as file_svc_del
        COMPONENT [ğŸ§¹ Servicio Limpieza] as cleanup_svc
    }
    
    ' Storage Layer Multi-Cloud
    package "â˜ï¸ Storage" as scrum15_storage {
        COMPONENT [ğŸ­ FÃ¡brica Almacenamiento] as storage_fact_del
        COMPONENT [ğŸ…¾ï¸ Repositorio OCI] as oci_repo_del
        COMPONENT [ğŸŸ  Repositorio AWS] as aws_repo_del
        COMPONENT [ğŸ”µ Repositorio Azure] as azure_repo_del
        COMPONENT [ğŸŸ¢ Repositorio GCP] as gcp_repo_del
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum15_data {
        COMPONENT [ğŸ“„ Repositorio Archivo] as file_repo_del
        COMPONENT [ğŸ“ Logger BÃ¡sico] as log_repo_del
        DATABASE "ğŸ˜ PostgreSQL" as db_delete
    }
    
    ' Flujo de eliminaciÃ³n
    delete_btn --> confirm_modal
    confirm_modal --> delete_ctrl
    delete_ctrl --> perm_val_del
    delete_ctrl --> file_svc_del
    file_svc_del --> cleanup_svc
    
    cleanup_svc --> storage_fact_del
    storage_fact_del --> oci_repo_del
    storage_fact_del --> aws_repo_del
    storage_fact_del --> azure_repo_del
    storage_fact_del --> gcp_repo_del
    
    cleanup_svc --> file_repo_del
    cleanup_svc --> log_repo_del
    file_repo_del --> db_delete
    log_repo_del --> db_delete
    
    delete_ctrl --> refresh_handler
}

note right of scrum15 : **Criterio de AceptaciÃ³n:**\nConfirmaciÃ³n antes de eliminar,\nactualizaciÃ³n automÃ¡tica de vista

!endsub

' ===============================
' SCRUM-17: CREAR CARPETAS
' ===============================
!startsub SCRUM17

package "ğŸ“ SCRUM-17: Crear Carpetas" as scrum17 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum17_frontend {
        COMPONENT [ğŸ“ BotÃ³n Crear Carpeta] as create_btn
        COMPONENT [ğŸ“ Modal Nombre Carpeta] as name_modal
        COMPONENT [âœ… Validador Carpeta] as folder_validator_fe
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum17_backend {
        COMPONENT [ğŸ“ Controlador Carpeta] as folder_ctrl_create
        COMPONENT [âœ… Validador Nombre] as name_validator
        COMPONENT [ğŸ“ Servicio Carpeta] as folder_svc
        COMPONENT [ğŸ” Verificador Duplicados] as duplicate_checker
    }
    
    ' Storage Layer Multi-Cloud
    package "â˜ï¸ Storage" as scrum17_storage {
        COMPONENT [ğŸ­ FÃ¡brica Almacenamiento] as storage_fact_folder
        COMPONENT [ğŸ…¾ï¸ Repositorio OCI] as oci_repo_folder
        COMPONENT [ğŸŸ  Repositorio AWS] as aws_repo_folder
        COMPONENT [ğŸ”µ Repositorio Azure] as azure_repo_folder
        COMPONENT [ğŸŸ¢ Repositorio GCP] as gcp_repo_folder
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum17_data {
        COMPONENT [ğŸ“ Repositorio Carpeta] as folder_repo_create
        DATABASE "ğŸ˜ PostgreSQL" as db_folder
    }
    
    ' Flujo de creaciÃ³n de carpeta
    create_btn --> name_modal
    name_modal --> folder_validator_fe
    folder_validator_fe --> folder_ctrl_create
    folder_ctrl_create --> name_validator
    name_validator --> duplicate_checker
    duplicate_checker --> folder_svc
    
    folder_svc --> storage_fact_folder
    storage_fact_folder --> oci_repo_folder
    storage_fact_folder --> aws_repo_folder
    storage_fact_folder --> azure_repo_folder
    storage_fact_folder --> gcp_repo_folder
    
    folder_svc --> folder_repo_create
    folder_repo_create --> db_folder
}

note right of scrum17 : **Criterio de AceptaciÃ³n:**\nCrear carpetas con nombres vÃ¡lidos,\nvalidaciÃ³n de duplicados

!endsub

' ===============================
' SCRUM-18: ORDENAR ARCHIVOS
' ===============================
!startsub SCRUM18

package "ğŸ”¤ SCRUM-18: Ordenar Archivos" as scrum18 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum18_frontend {
        COMPONENT [ğŸ”¤ Controles Ordenar] as sort_controls
        COMPONENT [ğŸ“Š Encabezado Tabla] as table_header
        COMPONENT [ğŸ—‚ï¸ Cambiador Vista] as view_switcher
        COMPONENT [ğŸ” Panel Filtro] as filter_panel
        COMPONENT [ğŸ’¾ Persistencia Orden] as sort_persistence
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum18_backend {
        COMPONENT [ğŸ”¤ Controlador Orden] as sort_ctrl
        COMPONENT [ğŸ” Constructor Consulta] as query_builder
        COMPONENT [ğŸ“Š Servicio Ordenar] as sort_svc
        COMPONENT [ğŸ“„ Servicio Archivo] as file_svc_sort
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum18_data {
        COMPONENT [ğŸ“„ Repositorio Archivo] as file_repo_sort
        COMPONENT [ğŸ” Repositorio BÃºsqueda] as search_repo
        DATABASE "ğŸ˜ PostgreSQL" as db_sort
    }
    
    ' Flujo de ordenamiento
    sort_controls --> table_header
    table_header --> sort_ctrl
    view_switcher --> sort_ctrl
    filter_panel --> sort_ctrl
    
    sort_ctrl --> query_builder
    query_builder --> sort_svc
    sort_svc --> file_svc_sort
    
    file_svc_sort --> file_repo_sort
    file_svc_sort --> search_repo
    file_repo_sort --> db_sort
    search_repo --> db_sort
    
    sort_ctrl --> sort_persistence
}

note right of scrum18 : **Criterio de AceptaciÃ³n:**\nOrdenar por nombre, fecha, tamaÃ±o, tipo.\nFiltros persistentes durante sesiÃ³n

!endsub

' ===============================
' SCRUM-28: BÃšSQUEDA DE ARCHIVOS
' ===============================
!startsub SCRUM28

package "ğŸ” SCRUM-28: BÃºsqueda de Archivos" as scrum28 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum28_frontend {
        COMPONENT [ğŸ” Componente BÃºsqueda] as search_comp
        COMPONENT [ğŸ“ Campo BÃºsqueda] as search_input
        COMPONENT [ğŸ›ï¸ Controles Filtro] as filter_controls
        COMPONENT [ğŸ“‹ Lista Resultados] as results_list
        COMPONENT [âš¡ BÃºsqueda Tiempo Real] as realtime_search
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum28_backend {
        COMPONENT [ğŸ” Controlador BÃºsqueda] as search_ctrl
        COMPONENT [ğŸ” Servicio BÃºsqueda] as search_svc
        COMPONENT [ğŸ“Š Servicio IndexaciÃ³n] as indexing_svc
        COMPONENT [ğŸ¯ Optimizador Consulta] as query_optimizer
    }
    
    ' Data Layer
    package "ğŸ—„ï¸ Data" as scrum28_data {
        COMPONENT [ğŸ” Repositorio BÃºsqueda] as search_repo_main
        COMPONENT [ğŸ“Š Repositorio Ãndice] as index_repo
        DATABASE "ğŸ˜ PostgreSQL" as db_search
    }
    
    ' Flujo de bÃºsqueda
    search_comp --> search_input
    search_input --> realtime_search
    search_comp --> filter_controls
    filter_controls --> search_ctrl
    realtime_search --> search_ctrl
    
    search_ctrl --> search_svc
    search_svc --> query_optimizer
    query_optimizer --> indexing_svc
    
    search_svc --> search_repo_main
    indexing_svc --> index_repo
    search_repo_main --> db_search
    index_repo --> db_search
    
    search_svc --> results_list
}

note right of scrum28 : **Criterio de AceptaciÃ³n:**\nBÃºsqueda por nombre y tipo de archivo,\nresultados en tiempo real

!endsub

' ===============================
' SCRUM-29: IMPRIMIR ARCHIVOS
' ===============================
!startsub SCRUM29

package "ğŸ–¨ï¸ SCRUM-29: Imprimir Archivos" as scrum29 {
    
    ' Frontend Components
    package "ğŸ–¥ï¸ Frontend" as scrum29_frontend {
        COMPONENT [ğŸ–¨ï¸ BotÃ³n Imprimir] as print_btn
        COMPONENT [âš™ï¸ DiÃ¡logo Imprimir] as print_dialog
        COMPONENT [ğŸ“„ Vista Previa ImpresiÃ³n] as print_preview
        COMPONENT [ğŸ›ï¸ ConfiguraciÃ³n ImpresiÃ³n] as print_settings
    }
    
    ' Backend Components
    package "ğŸ”§ Backend" as scrum29_backend {
        COMPONENT [ğŸ–¨ï¸ Controlador ImpresiÃ³n] as print_ctrl
        COMPONENT [ğŸ“„ Servicio ImpresiÃ³n] as print_svc
        COMPONENT [ğŸ”„ Convertidor Formato] as format_converter
        COMPONENT [ğŸ“Š Generador Imprimible] as printable_gen
    }
    
    ' Browser API
    package "ğŸŒ Browser" as scrum29_browser {
        COMPONENT [ğŸ–¨ï¸ API ImpresiÃ³n Navegador] as browser_print
        COMPONENT [ğŸ“„ Renderizador Documento] as doc_renderer
    }
    
    ' Flujo de impresiÃ³n
    print_btn --> print_dialog
    print_dialog --> print_settings
    print_settings --> print_preview
    print_preview --> print_ctrl
    
    print_ctrl --> print_svc
    print_svc --> format_converter
    format_converter --> printable_gen
    
    printable_gen --> doc_renderer
    doc_renderer --> browser_print
}

note right of scrum29 : **Criterio de AceptaciÃ³n:**\nImprimir desde vista previa,\nsoporte para PDF e imÃ¡genes

!endsub

' ===============================
' RELACIONES ENTRE HISTORIAS
' ===============================
package "ğŸ”— DEPENDENCIAS ENTRE HISTORIAS" as dependencies {
    
    scrum5 .down.> scrum10 : "Requiere autenticaciÃ³n"
    scrum10 .down.> scrum11 : "Panel base para acciones"
    scrum11 .down.> scrum12 : "BotÃ³n subir archivo"
    scrum12 .down.> scrum14 : "Archivos para previsualizar"
    scrum12 .down.> scrum15 : "Archivos para eliminar"
    scrum17 .down.> scrum18 : "Carpetas para ordenar"
    scrum18 .down.> scrum28 : "Estructura para bÃºsqueda"
    scrum14 .down.> scrum29 : "Vista previa para imprimir"
}

' ===============================
' LEYENDA ARQUITECTÃ“NICA
' ===============================
legend bottom left
|= SÃ­mbolo |= Significado |= PatrÃ³n Aplicado |
|ğŸ”| VerificaciÃ³n Credenciales | ComparaciÃ³n Simple |
|ğŸ“¤ğŸ“¥| GestiÃ³n Archivos | PatrÃ³n Repository |
|ğŸ“Š| Panel Control/MÃ©tricas | PatrÃ³n Facade |
|ğŸ­| FÃ¡brica Multi-Cloud | PatrÃ³n Factory |
|ğŸ”| BÃºsqueda | PatrÃ³n Observer |
|ğŸ‘¤| ValidaciÃ³n Propietario | PatrÃ³n Decorator |
|ğŸ“| Logging BÃ¡sico | Logger Simple |
|ğŸ…¾ï¸| Oracle Cloud (OCI) | Repository Pattern |
|ğŸŸ | Amazon Web Services | Repository Pattern |
|ğŸ”µ| Microsoft Azure | Repository Pattern |
|ğŸŸ¢| Google Cloud Platform | Repository Pattern |

**ğŸ—ï¸ Principios SOLID aplicados en Sprint 1:**
â€¢ **S**RP: Cada componente tiene una responsabilidad especÃ­fica
â€¢ **O**CP: Extensible para nuevos tipos de archivo/almacenamiento
â€¢ **L**SP: Las interfaces permiten intercambiar implementaciones
â€¢ **I**SP: Interfaces especÃ­ficas por funcionalidad
â€¢ **D**IP: Dependencias hacia abstracciones, no concreciones

**ğŸ“‹ Nota Sprint 1:** 
â€¢ Sistema bÃ¡sico sin roles/permisos avanzados
â€¢ Validaciones de propietario Ãºnicamente
â€¢ AutenticaciÃ³n simple: verificaciÃ³n email/password vs BD
â€¢ Sin JWT, tokens, ni middleware de autenticaciÃ³n
â€¢ Arquitectura multi-cloud: AWS, Azure, GCP, OCI
endlegend

@enduml